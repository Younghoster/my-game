{"version":3,"sources":["Home.js"],"names":["Global","require","utils","cc","Class","extends","Component","properties","moneyLabel","default","type","Label","skilBox","Node","explain","shopBox","Prefab","signInBox","audioBgm","AudioClip","checkSign","now","timeFormat","split","last","userInfo","signDate","box","instantiate","y","x","parent","node","skilBtn","e","num","Number","dash","showToast","gameInfo","startDash","saveData","director","loadScene","boom","orcBoom","fanatical","crazy","switchSkillBox","show","skillMove","action","moveTo","height","easing","easeExponentialOut","seq","sequence","callFunc","runAction","switchShop","shopMove","shop","switchExplain","explainMove","width","updateUserInfo","string","money","find","getComponent","openGame","playBgm","openRank","onLoad","home","fetchData","preloadScene","console","log","audioEngine","playMusic","start","window","wx","getUserInfo","success","res","fail","_w","getSystemInfoSync","windowWidth","_h","windowHeight","warn","loginBtn","createUserInfoButton","text","style","left","top","lineHeight","backgroundColor","color","textAlign","fontSize","borderRadius","onTap","errMsg","destroy","showShareMenu","onShareAppMessage","title","shareInfo","imageUrl","url"],"mappings":"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","file":"Home.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Home","sourcesContent":["const Global = require('Global');\r\nconst utils = require('utils');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 金币\r\n        moneyLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        // 技能选择\r\n        skilBox: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // 说明\r\n        explain: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // 商店\r\n        shopBox: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // 签到资源\r\n        signInBox: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // bgm\r\n        audioBgm: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n    // 检查是否可以签到\r\n    checkSign() {\r\n        let now = utils.timeFormat().split(' ')[0];\r\n        let last = Global.userInfo.signDate.split(' ')[0];\r\n        // console.log(now, last);\r\n        if (now != last) {\r\n            let box = cc.instantiate(this.signInBox);\r\n            box.y = box.x = 0;\r\n            box.parent = this.node;\r\n        } \r\n    },\r\n    // 技能按钮\r\n    skilBtn(e, num) {\r\n        switch (Number(num)) {\r\n            case 1:\r\n                if (Global.userInfo.dash == 0) {\r\n                    utils.showToast('当前道具为0，无法使用');\r\n                } else {\r\n                    Global.userInfo.dash -= 1;\r\n                    Global.gameInfo.startDash = 3;\r\n                    Global.saveData();\r\n                    cc.director.loadScene('Game');\r\n                }\r\n                break;\r\n            case 2:\r\n                if (Global.userInfo.boom == 0) {\r\n                    utils.showToast('当前道具为0，无法使用');\r\n                } else {\r\n                    Global.userInfo.boom -= 1;\r\n                    Global.saveData();\r\n                    Global.gameInfo.orcBoom = 3;\r\n                    cc.director.loadScene('Game');\r\n                }\r\n                break;\r\n            case 3:\r\n                if (Global.userInfo.fanatical == 0) {\r\n                    utils.showToast('当前道具为0，无法使用');\r\n                } else {\r\n                    Global.userInfo.fanatical -= 1;\r\n                    Global.saveData();\r\n                    Global.gameInfo.crazy = 2;\r\n                    cc.director.loadScene('Game');\r\n                }\r\n                break;\r\n        }\r\n    },\r\n    // 技能选择切换\r\n    switchSkillBox(e, show = null) {\r\n        if (this.skillMove) return;\r\n        this.skillMove = true;\r\n        let action = null;\r\n        if (show) {\r\n            action = cc.moveTo(0.5, 0, 0);\r\n        } else {\r\n            action = cc.moveTo(0.5, 0, -this.node.height);\r\n        }\r\n        action.easing(cc.easeExponentialOut(3.0));\r\n        let seq = cc.sequence(action, cc.callFunc(() => {\r\n            this.skillMove = false;\r\n        }));\r\n        this.skilBox.runAction(seq);\r\n    },\r\n    // 商店切换\r\n    switchShop(e, show = null) {\r\n        if (this.shopMove) return;\r\n        this.shopMove = true;\r\n        let action = null;\r\n        if (show) {\r\n            action = cc.moveTo(0.5, 0, 0);\r\n        } else {\r\n            action = cc.moveTo(0.5, 0, this.node.height);\r\n        }\r\n        action.easing(cc.easeExponentialOut(3.0));\r\n        let seq = cc.sequence(action, cc.callFunc(() => {\r\n            this.shopMove = false;\r\n        }));\r\n        this.shop.runAction(seq);\r\n    },\r\n    // 说明切换\r\n    switchExplain(e, show = null) {\r\n        if (this.explainMove) return;\r\n        this.explainMove = true;\r\n        let action = null;\r\n        let seq = null;\r\n        if (show) {\r\n            action = cc.moveTo(0.5, 0, 0);\r\n            action.easing(cc.easeExponentialOut(3.0));\r\n        } else {\r\n            action = cc.moveTo(0.5, -this.node.width, 0);\r\n            action.easing(cc.easeExponentialOut(3.0));\r\n        }\r\n        seq = cc.sequence(action, cc.callFunc(() => {\r\n            this.explainMove = false;\r\n        }));\r\n        this.explain.runAction(seq);\r\n    },\r\n    // 更新用户数据\r\n    updateUserInfo() {\r\n        // 修改金币\r\n        this.moneyLabel.string = Global.userInfo.money;\r\n        cc.find('money/text', this.shop).getComponent(cc.Label).string = Global.userInfo.money;\r\n        \r\n        cc.find('skill-1/content', this.skilBox).getComponent(cc.Label).string = '高能陨石 ×' + Global.userInfo.dash;\r\n        cc.find('skill-2/content', this.skilBox).getComponent(cc.Label).string = '炸弹多多 ×' + Global.userInfo.boom;\r\n        cc.find('skill-3/content', this.skilBox).getComponent(cc.Label).string = '兽人狂暴 ×' + Global.userInfo.fanatical;\r\n\r\n        if (Global.userInfo.dash == 0) {\r\n            cc.find('skill-1/btn/text', this.skilBox).getComponent(cc.Label).string = '不可用';\r\n        } else{\r\n            cc.find('skill-1/btn/text', this.skilBox).getComponent(cc.Label).string = '使用';\r\n        } \r\n        if (Global.userInfo.boom == 0) {\r\n            cc.find('skill-2/btn/text', this.skilBox).getComponent(cc.Label).string = '不可用';\r\n        } else {\r\n            cc.find('skill-2/btn/text', this.skilBox).getComponent(cc.Label).string = '使用';\r\n        }\r\n        \r\n        if (Global.userInfo.fanatical == 0) {\r\n            cc.find('skill-3/btn/text', this.skilBox).getComponent(cc.Label).string = '不可用';\r\n        } else {\r\n            cc.find('skill-3/btn/text', this.skilBox).getComponent(cc.Label).string = '使用';\r\n        }\r\n        \r\n    },\r\n    openGame() {\r\n        Global.playBgm = true;\r\n        cc.director.loadScene('Game');\r\n    },\r\n    openRank() {\r\n        Global.playBgm = true;\r\n        cc.director.loadScene('Rank');\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        Global.home = this;\r\n        // 获取本地数据\r\n        if (Global.fetchData()) Global.userInfo = Global.fetchData();\r\n\r\n        // 输出商店\r\n        this.shop = cc.instantiate(this.shopBox);\r\n        this.shop.parent = this.node;\r\n\r\n        // 重置位置\r\n        this.shop.y = this.node.height;\r\n        this.skilBox.y = -this.node.height;\r\n        this.explain.width = this.node.width;\r\n        this.explain.height = this.node.height;\r\n        this.explain.x = -this.node.width;\r\n\r\n        // 更新数据\r\n        this.updateUserInfo();\r\n\r\n        // 检测签到\r\n        this.checkSign();\r\n\r\n        cc.director.preloadScene('Game', () => console.log('预加载游戏场景成功'));\r\n        // 背景音乐\r\n        if (!Global.playBgm) {\r\n            cc.audioEngine.playMusic(this.audioBgm, true);\r\n        }\r\n    },\r\n\r\n    start() {\r\n        if (window.wx) {\r\n            // 检测用户是否授权过\r\n            wx.getUserInfo({\r\n                success(res) {\r\n                    console.log('用户授权信息====>', res);\r\n                },\r\n                fail() {\r\n                    let _w = wx.getSystemInfoSync().windowWidth,\r\n                        _h = wx.getSystemInfoSync().windowHeight;\r\n                    console.warn('创建获取用户信息按钮');\r\n                    // 创建获取用户信息按钮\r\n                    let loginBtn = wx.createUserInfoButton({\r\n                        type: 'text',\r\n                        text: '',\r\n                        style: {\r\n                            left: 0,\r\n                            top: 0,\r\n                            width: _w,\r\n                            height: _h,\r\n                            lineHeight: _h,\r\n                            backgroundColor: 'rgba(0, 0, 0, 0)',\r\n                            color: 'rgba(0, 0, 0, 0)',\r\n                            textAlign: 'center',\r\n                            fontSize: 16,\r\n                            borderRadius: 4\r\n                        }\r\n                    });\r\n                    // 监听点击事件\r\n                    loginBtn.onTap(res => {\r\n                        console.log('用户授权数据：', res);\r\n                        if (res.errMsg != 'getUserInfo:ok') return;\r\n                        loginBtn.destroy();\r\n                    });\r\n                }\r\n            });\r\n            // 显示分享按钮\r\n            wx.showShareMenu();\r\n            // 设置转发分内容\r\n            wx.onShareAppMessage(res => {\r\n                return {\r\n                    title: Global.shareInfo.title,\r\n                    imageUrl: Global.shareInfo.url,\r\n                }\r\n            });\r\n        }\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}