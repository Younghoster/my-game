{"version":3,"sources":["Ball.js"],"names":["Global","require","colors","mountain","tree","floor","ground","cc","Class","extends","Component","properties","moveBox","default","type","Node","bgColor","audioFloor","AudioClip","audioDeath","audioBox","audioBoom","audioBoard","scoreLabel","Label","moneyLabel","moneyTip","explodeBoom","Prefab","explodeGold","moneyTipMove","num","userInfo","money","string","show","spawn","fadeIn","scaleTo","stop","hide","fadeOut","seq","sequence","easing","easeOut","node","runAction","viewScale","val","y","game","wrap","scale","colorSwitch","transform","key","callFunc","color","hexToColor","bgMove","_w","width","sun","getChildByName","cloud","x","bg_speed","gameInfo","level","countToatal","minNumber","console","log","opacity","score_count","score","restData","bone","abs","floorNum","startDash","value","getComponent","dragonBones","ArmatureDisplay","timeScale","collisionFloor","window","wx","vibrateShort","state","height","bounce","playAnimation","ParticleSystem","stopSystem","gameOver","audioEngine","play","collisionBoard","destroy","isBoard","scheduleOnce","collisionOrc","explode","orcPool","put","total","creatOrc","collisionStorehouse","boom","instantiate","setPosition","parent","map","parseInt","Math","random","collisionBomb","nodeShock","onCollisionEnter","other","self","name","onLoad","update","dt"],"mappings":"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","file":"Ball.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Game","sourcesContent":["const Global = require('Global');\r\nconst colors = [\r\n    {\r\n        mountain: '#7D2C1B',\r\n        tree: '#491D12',\r\n        floor: '#75280C',\r\n        ground: '#3D1805',\r\n    },{\r\n        mountain: '#81b68c',\r\n        tree: '#65977a',\r\n        floor: '#e5c282',\r\n        ground: '#2b5748',\r\n    }\r\n]\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 风景移动容器\r\n        moveBox: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // 背景容器（canvas大小）\r\n        bgColor: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        // 音效\r\n        audioFloor: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        audioDeath: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        audioBox: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        audioBoom: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        audioBoard: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        // 分数\r\n        scoreLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        // 金币\r\n        moneyLabel: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        // 掉落金币提示\r\n        moneyTip: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        // 炸弹粒子\r\n        explodeBoom: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // 金币粒子\r\n        explodeGold: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n    },\r\n    // 掉落金币提示动画\r\n    moneyTipMove(num) {\r\n        Global.userInfo.money += num;\r\n        this.moneyLabel.string = Global.userInfo.money;\r\n        this.moneyTip.string = '金币 +' + num;\r\n        let show = cc.spawn(cc.fadeIn(0.3), cc.scaleTo(0.3, 2, 2));\r\n        let stop = cc.scaleTo(0.5, 1, 1);\r\n        let hide = cc.spawn(cc.fadeOut(0.3), cc.scaleTo(0.3, 1, 1));\r\n        let seq = cc.sequence(show, stop, hide);\r\n        seq.easing(cc.easeOut(3.0));\r\n        this.moneyTip.node.runAction(seq);\r\n    },\r\n\r\n    // 视觉缩放\r\n    viewScale() {\r\n        let val = 500;  // 正常弹起高度\r\n        if (this.node.y < val) return;\r\n\r\n        // 第一种（性能更好）\r\n        Global.game.wrap.scale = val / this.node.y;\r\n        \r\n        /**\r\n         * 第二种（有点小瑕疵）\r\n         * 75：球的半径\r\n         * 890：球弹起来的最大高度\r\n         */\r\n        // let ss = 75 / (890 / this.node.y);\r\n        // Global.game.wrap.scale = (val - ss) / this.node.y;\r\n    },\r\n\r\n    // 颜色过渡切换\r\n    colorSwitch(mountain, tree, floor, ground, num) {\r\n        function transform(node, key) {\r\n            let seq = cc.sequence(cc.fadeOut(0.3), cc.callFunc(() => {\r\n                node.color = cc.hexToColor(colors[num][key]);\r\n            }), cc.fadeIn(0.3));\r\n            node.runAction(seq);\r\n        }\r\n        transform(mountain, 'mountain');\r\n        transform(tree, 'tree');\r\n        transform(floor, 'floor');\r\n        transform(ground, 'ground'); \r\n    },\r\n\r\n    // 背景移动\r\n    bgMove() {\r\n        const _w = this.moveBox.width;\r\n        let sun = this.moveBox.getChildByName('sun'),\r\n            tree = this.moveBox.getChildByName('tree'),\r\n            mountain = this.moveBox.getChildByName('mountain'),\r\n            floor = this.moveBox.getChildByName('floor'),\r\n            ground = this.moveBox.getChildByName('ground'),\r\n            cloud = this.moveBox.getChildByName('cloud');\r\n        // 太阳 移动 \r\n        sun.x -= this.bg_speed;\r\n        if (sun.x <= -sun.width) {\r\n            sun.x = _w;\r\n\r\n            // 难度增加\r\n            Global.gameInfo.level = Global.gameInfo.countToatal == Global.gameInfo.minNumber ? Global.gameInfo.level : Global.gameInfo.level + 1;\r\n            console.log('难度增加======>', Global.gameInfo.level);\r\n\r\n            // 判断切换背景颜色\r\n            if (sun.opacity == 255) {\r\n                this.colorSwitch(mountain, tree, floor, ground, 1);\r\n                // this.bgColor.getChildByName('color-1').runAction(cc.fadeOut(0.3));\r\n                this.bgColor.getChildByName('color-2').runAction(cc.fadeIn(0.3));\r\n                sun.runAction(cc.fadeOut(0.3));\r\n                cloud.runAction(cc.fadeIn(0.3));\r\n            } else {\r\n                this.colorSwitch(mountain, tree, floor, ground, 0);\r\n                this.bgColor.getChildByName('color-2').runAction(cc.fadeOut(0.3));\r\n                // this.bgColor.getChildByName('color-1').runAction(cc.fadeIn(0.3));\r\n                sun.runAction(cc.fadeIn(0.3));\r\n                cloud.runAction(cc.fadeOut(0.3));\r\n            }\r\n        }\r\n\r\n        // 分数\r\n        this.score_count += this.bg_speed;\r\n        if (this.score_count >= 5) {\r\n            this.score_count = 0;\r\n            Global.gameInfo.score += 1;\r\n            this.scoreLabel.string = Global.gameInfo.score + 'm';\r\n        }\r\n\r\n        // 云移动\r\n        cloud.x -= this.bg_speed * 2;\r\n        if (cloud.x <= -cloud.width) cloud.x = _w;\r\n\r\n        // 山丘移动\r\n        mountain.x -= this.bg_speed * 4;\r\n        if (mountain.x <= -_w) mountain.x = 0;\r\n\r\n        // 树木移动\r\n        tree.x -= this.bg_speed * 5;\r\n        if (tree.x <= -_w) tree.x = 0\r\n\r\n        // gound移动\r\n        ground.x -= this.bg_speed * 6;\r\n        if (ground.x <= -_w) ground.x = 0;\r\n    },\r\n\r\n    // 重置下参数\r\n    restData(num = 0, bone = false, abs = 1) {\r\n        // 砸地板计数\r\n        this.floorNum = num;\r\n       \r\n        /**\r\n         * 背景移动速度\r\n         * 判断不是在高能陨石模式下才执行\r\n         */\r\n        if (!Global.gameInfo.startDash) {\r\n            this.bg_speed += abs;\r\n            if (this.bg_speed > 5) this.bg_speed = 5;\r\n            if (this.bg_speed < 1) this.bg_speed = 1;\r\n        }\r\n        console.log('背景移动速度=====>', this.bg_speed);\r\n        \r\n        // 衰减值\r\n        this.value = 0.5;\r\n        if (bone) {\r\n            this.node.getChildByName('bone').getComponent(dragonBones.ArmatureDisplay).timeScale = 0.5;\r\n        } else {\r\n            this.node.getChildByName('bone').getComponent(dragonBones.ArmatureDisplay).timeScale = 1;\r\n        }\r\n    },\r\n\r\n    // 撞到地板\r\n    collisionFloor() {\r\n        if (window.wx) wx.vibrateShort();\r\n        this.floorNum += 5;\r\n        if (this.floorNum >= 25) {\r\n            // cc.log('游戏结束'); \r\n            Global.gameInfo.state = 'over';\r\n            this.node.y = this.node.height / 2;\r\n            this.bounce = 0;\r\n            this.node.getChildByName('bone').getComponent(dragonBones.ArmatureDisplay).playAnimation('rockStop', 1);\r\n            this.node.getChildByName('particle').getComponent(cc.ParticleSystem).stopSystem();\r\n            Global.game.gameOver();\r\n        } else {\r\n            this.bounce = 25 - this.floorNum;\r\n        }\r\n        \r\n        // cc.log('撞到地面', this.floorNum);\r\n\r\n        this.restData(this.floorNum, true, -2);\r\n        cc.audioEngine.play(this.audioFloor, false);\r\n    },\r\n    // 撞到木板\r\n    collisionBoard(node) {\r\n        if (Global.gameInfo.state == 'over' || this.value <= 1) return; \r\n        if (window.wx) wx.vibrateShort();\r\n        this.bounce = 15;       // 上升高度\r\n        this.floorNum = 10;\r\n        node.destroy();\r\n        this.isBoard = true; // 碰到木板\r\n        this.scheduleOnce(() => {\r\n            this.restData(this.floorNum, false, -1);\r\n            this.isBoard = false;\r\n            console.log('floorNum', this.floorNum);\r\n        }, 0.01);\r\n        cc.audioEngine.play(this.audioBoard, false);\r\n    },\r\n    // 撞到兽人\r\n    collisionOrc(node) {\r\n        if (Global.gameInfo.state == 'over' || this.value <= 1 || this.isBoard) return; \r\n        if (window.wx) wx.vibrateShort();\r\n        // console.log('衰减值=======>', this.value);\r\n        if (this.bounce < 20 && !this.isBoard) this.bounce = 20;       // 上升高度\r\n        \r\n        // 播放溅血粒子\r\n        Global.game.explode(node);\r\n        // 回收兽人\r\n        Global.game.orcPool.put(node);\r\n        \r\n        // 做难度判断是否生成兽人\r\n        if (Global.gameInfo.total - Global.gameInfo.level >= Global.gameInfo.countToatal) {\r\n            Global.game.creatOrc();\r\n        } else {\r\n            console.log('减少一个兽人============>');\r\n            Global.gameInfo.countToatal = Global.gameInfo.countToatal <= Global.gameInfo.minNumber ? Global.gameInfo.minNumber : Global.gameInfo.countToatal - 1;\r\n        }\r\n        \r\n        this.scheduleOnce(() => {\r\n            if (!this.isBoard) this.restData();\r\n        }, 0.01);\r\n        \r\n        cc.audioEngine.play(this.audioDeath, false);\r\n    },\r\n\r\n    // 撞到宝箱\r\n    collisionStorehouse(node) {\r\n        if (Global.gameInfo.state == 'over' || this.value <= 1) return; \r\n        if (window.wx) wx.vibrateShort();\r\n        if (this.bounce < 25) this.bounce = 25;       // 上升高度\r\n        node.destroy();\r\n\r\n        // 播放粒子\r\n        let boom = cc.instantiate(this.explodeGold);\r\n        boom.setPosition(node.x + 50, node.y + 50);\r\n        boom.parent = Global.game.map;\r\n\r\n        // 金币更新\r\n        let num = parseInt(50 * Math.random()) + 50;\r\n        this.moneyTipMove(num);\r\n\r\n        this.scheduleOnce(() => {\r\n            this.restData();\r\n        }, 0.01);\r\n        cc.audioEngine.play(this.audioBox, false);\r\n    },\r\n\r\n    // 撞到炸弹\r\n    collisionBomb(node) {\r\n        if (Global.gameInfo.state == 'over' || this.value <= 1) return; \r\n        Global.game.nodeShock();\r\n        this.bounce = 30;       // 上升高度\r\n        node.destroy();\r\n\r\n        // 播放粒子\r\n        let boom = cc.instantiate(this.explodeBoom);\r\n        boom.setPosition(node.x + 50, node.y + 50);\r\n        boom.parent = Global.game.map;\r\n\r\n        this.scheduleOnce(() => {\r\n            this.restData();\r\n        }, 0.01);\r\n        cc.audioEngine.play(this.audioBoom, false);\r\n    },\r\n\r\n    // 碰撞回调\r\n    onCollisionEnter(other, self) {\r\n        // console.log(other.node.name);\r\n        \r\n        switch (other.node.name) {\r\n            case 'floor':\r\n                this.collisionFloor();\r\n                break;\r\n            case 'orc':\r\n                this.collisionOrc(other.node);\r\n                break;\r\n            case 'storehouse':\r\n                this.collisionStorehouse(other.node);\r\n                break;\r\n            case 'bomb':\r\n                this.collisionBomb(other.node);\r\n                break;\r\n            case 'board':\r\n                this.collisionBoard(other.node);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        // 弹力值\r\n        this.bounce = 0;\r\n        // 设置速度\r\n        this.bg_speed = 0;\r\n        this.restData();\r\n        // 分数计数（模拟距离）\r\n        this.score_count = 0;\r\n\r\n        this.moneyLabel.string = Global.userInfo.money;\r\n    },\r\n\r\n    // start() {},\r\n\r\n    update(dt) {\r\n        if (Global.gameInfo.state == 'running') {\r\n            // 背景移动\r\n            this.bgMove();\r\n\r\n            // 视觉缩放监听\r\n            this.viewScale();\r\n            \r\n            // 第一种\r\n            this.bounce -= 1 * this.value;\r\n            this.node.y += this.bounce;\r\n            // console.log(this.bounce * this.value);\r\n            \r\n            // 防止掉落\r\n            if (this.node.y < 0) this.node.y = this.node.width / 2 + 1;\r\n        }\r\n    },\r\n});\r\n"]}