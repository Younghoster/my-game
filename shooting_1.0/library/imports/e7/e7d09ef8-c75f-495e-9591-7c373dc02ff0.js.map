{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\game/assets\\Script\\game\\block.js"],"names":["Global","require","cc","Class","extends","Component","properties","blastPrefab","default","type","Prefab","createBlast","blast","gameData","blastPool","size","get","log","instantiate","setPosition","node","x","y","parent","game","blockBox","onCollisionEnter","other","self","name","score","Number","getChildByName","getComponent","Label","string","blockPool","put","xSpeed","RigidBody","linearVelocity","v2","onLoad","_w","width","BoxCollider","height","offset","start","update","dt"],"mappings":";;;;;;AAAA,IAAMA,SAASC,QAAQ,QAAR,CAAf;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,qBAAa;AACTC,qBAAS,IADA;AAETC,kBAAMP,GAAGQ;AAFA;AAFL,KAHP;AAUL;AACAC,eAXK,yBAWS;AACV,YAAIC,QAAQ,IAAZ;AACA,YAAIZ,OAAOa,QAAP,CAAgBC,SAAhB,CAA0BC,IAA1B,KAAmC,CAAvC,EAA0C;AACtCH,oBAAQZ,OAAOa,QAAP,CAAgBC,SAAhB,CAA0BE,GAA1B,EAAR;AACH,SAFD,MAEO;AACHd,eAAGe,GAAH,CAAO,QAAP;AACAL,oBAAQV,GAAGgB,WAAH,CAAe,KAAKX,WAApB,CAAR;AACH;AACD;;AAEAK,cAAMO,WAAN,CAAkB,KAAKC,IAAL,CAAUC,CAA5B,EAA+B,KAAKD,IAAL,CAAUE,CAAzC;AACAV,cAAMW,MAAN,GAAevB,OAAOwB,IAAP,CAAYC,QAA3B;AACH,KAvBI;;AAwBL;AACAC,oBAzBK,4BAyBYC,KAzBZ,EAyBmBC,IAzBnB,EAyByB;AAC1B;AACA,YAAID,MAAMP,IAAN,CAAWS,IAAX,IAAmB,QAAvB,EAAiC;AAC7B,gBAAIC,QAAQC,OAAO,KAAKX,IAAL,CAAUY,cAAV,CAAyB,SAAzB,EAAoCC,YAApC,CAAiD/B,GAAGgC,KAApD,EAA2DC,MAAlE,CAAZ;AACA,gBAAIL,SAAS,CAAb,EAAgB;AACZ;;AAEA;AACA;AACA;;AAEA9B,uBAAOa,QAAP,CAAgBuB,SAAhB,CAA0BC,GAA1B,CAA8B,KAAKjB,IAAnC;AACH,aARD,MAQO;AACH,qBAAKA,IAAL,CAAUY,cAAV,CAAyB,SAAzB,EAAoCC,YAApC,CAAiD/B,GAAGgC,KAApD,EAA2DC,MAA3D,GAAoEL,QAAQ,CAA5E;AACH;AACJ;AACD;AACA,YAAIH,MAAMP,IAAN,CAAWS,IAAX,IAAmB,MAAvB,EAA+B;AAC3B,gBAAIS,SAAS,CAAE,KAAKlB,IAAL,CAAUa,YAAV,CAAuB/B,GAAGqC,SAA1B,EAAqCC,cAArC,CAAoDnB,CAAnE;AACA,iBAAKD,IAAL,CAAUa,YAAV,CAAuB/B,GAAGqC,SAA1B,EAAqCC,cAArC,GAAsDtC,GAAGuC,EAAH,CAAMH,MAAN,EAAc,CAAC,GAAf,CAAtD;AACH;AAEJ,KA/CI;;AAgDL;;AAEAI,UAlDK,oBAkDK;AACN;AACA,YAAIC,KAAK,KAAKvB,IAAL,CAAUwB,KAAnB;AACA,aAAKxB,IAAL,CAAUa,YAAV,CAAuB/B,GAAG2C,WAA1B,EAAuC9B,IAAvC,CAA4C6B,KAA5C,GAAoD,KAAKxB,IAAL,CAAUa,YAAV,CAAuB/B,GAAG2C,WAA1B,EAAuC9B,IAAvC,CAA4C+B,MAA5C,GAAqDH,EAAzG;AACA,aAAKvB,IAAL,CAAUa,YAAV,CAAuB/B,GAAG2C,WAA1B,EAAuCE,MAAvC,CAA8C1B,CAA9C,GAAkDsB,KAAK,CAAvD;AACA,aAAKvB,IAAL,CAAUa,YAAV,CAAuB/B,GAAG2C,WAA1B,EAAuCE,MAAvC,CAA8CzB,CAA9C,GAAkD,CAACqB,EAAD,GAAM,CAAxD;AACH,KAxDI;AA0DLK,SA1DK,mBA0DI,CAER,CA5DI;AA8DLC,UA9DK,kBA8DGC,EA9DH,EA8DO;AACR,YAAI,KAAK9B,IAAL,CAAUE,CAAV,IAAe,IAAnB,EAAyB;AACrBtB,mBAAOa,QAAP,CAAgBuB,SAAhB,CAA0BC,GAA1B,CAA8B,KAAKjB,IAAnC;AACA;AACH;AACJ;AAnEI,CAAT","file":"block.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\game","sourcesContent":["const Global = require(\"Global\")\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 生成的粒子资源\r\n        blastPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n    },\r\n    // 生成一个爆炸粒子\r\n    createBlast() {\r\n        let blast = null;\r\n        if (Global.gameData.blastPool.size() > 0) {\r\n            blast = Global.gameData.blastPool.get();\r\n        } else {\r\n            cc.log('创建一个粒子')\r\n            blast = cc.instantiate(this.blastPrefab);\r\n        }\r\n        // console.log(Global.game.node);\r\n        \r\n        blast.setPosition(this.node.x, this.node.y);\r\n        blast.parent = Global.game.blockBox;\r\n    },\r\n    // 碰撞检测\r\n    onCollisionEnter(other, self) {\r\n        // 子弹碰撞\r\n        if (other.node.name == 'bullet') {\r\n            let score = Number(this.node.getChildByName('boxtext').getComponent(cc.Label).string);\r\n            if (score == 1) {\r\n                // this.createBlast()\r\n\r\n                // let blast = cc.instantiate(this.blastPrefab);\r\n                // blast.setPosition(this.node.x + this.node.width / 2, this.node.y - this.node.height / 2);\r\n                // blast.parent = Global.game.blockBox;\r\n\r\n                Global.gameData.blockPool.put(this.node)\r\n            } else {\r\n                this.node.getChildByName('boxtext').getComponent(cc.Label).string = score - 1\r\n            } \r\n        }\r\n        // 碰撞到墙，反弹\r\n        if (other.node.name == 'wall') {\r\n            let xSpeed = -(this.node.getComponent(cc.RigidBody).linearVelocity.x)\r\n            this.node.getComponent(cc.RigidBody).linearVelocity = cc.v2(xSpeed, -400)\r\n        }\r\n        \r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        // 设置碰撞包围（大小变动的时候包围不会自动跟随）\r\n        let _w = this.node.width;\r\n        this.node.getComponent(cc.BoxCollider).size.width = this.node.getComponent(cc.BoxCollider).size.height = _w;\r\n        this.node.getComponent(cc.BoxCollider).offset.x = _w / 2;\r\n        this.node.getComponent(cc.BoxCollider).offset.y = -_w / 2;\r\n    },\r\n\r\n    start () {\r\n        \r\n    },\r\n\r\n    update (dt) {\r\n        if (this.node.y <= 0.01) {\r\n            Global.gameData.blockPool.put(this.node)\r\n            // cc.log('方块到达底部回收')\r\n        }\r\n    },\r\n});\r\n"]}