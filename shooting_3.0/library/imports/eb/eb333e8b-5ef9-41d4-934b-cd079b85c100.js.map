{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\game/assets\\Script\\game\\blockList.js"],"names":["Global","require","cc","Class","extends","Component","properties","blockPrefab","default","type","Prefab","resetBlock","el","sum","index","spacing","height","num","score","computeScore","_w","node","width","_x","_y","parseInt","Math","random","datatype","getComponent","BoxCollider","size","offset","x","y","getChildByName","Label","string","color","Color","randomColor","maxNum","setPosition","createBlock","block","instantiate","parent","active","createBlockList","i","resetTop","children","filter","item","name","gameData","level","listSpacing","length","stopAllActions","blockMove","num1","num2","els","toLeft","moveTo","toRight","leftTo","rightTo","seq","repeatForever","sequence","seq2","runAction","start","update","dt","console","log"],"mappings":"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","file":"blockList.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\game","sourcesContent":["const Global = require(\"Global\")\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 生成的方块资源\r\n        blockPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n    },\r\n    /**\r\n     * 重置方块属性\r\n     * @param {*} el 元素\r\n     * @param {*} sum 总数\r\n     * @param {*} index 位置\r\n     */\r\n    resetBlock(el, sum, index) {\r\n        let spacing = 10;\r\n        let height = 100;\r\n        let num = sum / 2;\r\n        let score = Global.computeScore().score;\r\n        let _w = (this.node.width - (num + 1) * spacing) / num;\r\n        let _x = index < num ? index * (_w + spacing) + spacing : (index - num) * (_w + spacing) + spacing;\r\n        let _y = index < num ? 0 : height + spacing;\r\n        let type = parseInt(2 * Math.random()) + 1;\r\n        // 设置宽高\r\n        el.width = _w;\r\n        el.height = height;\r\n        // 随机给一个颜色类型\r\n        el.datatype = type;\r\n        // 设置碰撞包围\r\n        el.getComponent(cc.BoxCollider).size.width = _w;\r\n        el.getComponent(cc.BoxCollider).size.height = height;\r\n        el.getComponent(cc.BoxCollider).offset.x = _w / 2;\r\n        el.getComponent(cc.BoxCollider).offset.y = -(height / 2);\r\n        // 重置分数\r\n        el.getChildByName('boxtext').getComponent(cc.Label).string = score;\r\n        // 重置颜色\r\n        el.color = new cc.Color(Global.randomColor(score, type, Global.computeScore().maxNum));\r\n        // 重置位置\r\n        el.setPosition(_x, _y);\r\n    },\r\n    // 创建方块\r\n    createBlock(sum, index) {\r\n        let block = cc.instantiate(this.blockPrefab);\r\n        this.resetBlock(block, sum, index);\r\n        block.parent = this.node;\r\n        if (index > 4) block.active = false;\r\n    },\r\n    // 生成一列方块\r\n    createBlockList() {\r\n        let num = 10;\r\n        for (let i = 0; i < num; i++) {\r\n            this.createBlock(num, i)\r\n        }\r\n    },\r\n    // 重置回到顶部\r\n    resetTop() {\r\n        let children = this.node.children.filter(item => item.name == 'block');\r\n        let type = Global.gameData.level > 1 ? parseInt(4 * Math.random()) + 1 : 0;\r\n        // 让列表回到最上方\r\n        this.node.setPosition(0, 3 * Global.gameData.listSpacing + this.node.height);\r\n        // 重置回到顶部的所有子元素\r\n        for (let i = 0; i < children.length; i++) {\r\n            children[i].active = true;\r\n            children[i].stopAllActions();\r\n            this.resetBlock(children[i], children.length, i);\r\n        }\r\n        // 设置移动方块\r\n        switch (type) {\r\n            case 1:\r\n                // cc.log('执行第一种移动方案');\r\n                children[0].active = children[4].active = false;\r\n                this.blockMove(1, 3, children);\r\n                break;\r\n            case 2:\r\n                // cc.log('执行第二种移动方案');\r\n                children[1].active = children[8].active = false;\r\n                this.blockMove(9, 0, children);\r\n                break;\r\n            case 3:\r\n                // cc.log('执行第三种移动方案');\r\n                children[5].active = children[9].active = false;\r\n                this.blockMove(6, 8, children);\r\n                break;\r\n            case 4:\r\n                // cc.log('执行第四种移动方案');\r\n                children[3].active = children[6].active = false;\r\n                this.blockMove(4, 5, children);\r\n                break;\r\n        }\r\n    },\r\n    // 随机移动\r\n    blockMove(num1, num2, els) {\r\n        let toLeft = cc.moveTo(1, els[num2].x, els[num2].y),\r\n            toRight = cc.moveTo(1, els[num2].x + els[num2].width + 10, els[num2].y),\r\n            leftTo = cc.moveTo(1, els[num1].x - els[num1].width + 10, els[num1].y),\r\n            rightTo = cc.moveTo(1, els[num1].x, els[num1].y);\r\n        let seq = cc.repeatForever(cc.sequence(toRight, toLeft)),\r\n            seq2 = cc.repeatForever(cc.sequence(leftTo, rightTo));\r\n        els[num2].runAction(seq);\r\n        els[num1].runAction(seq2);\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() {\r\n        this.createBlockList()\r\n    },\r\n\r\n    update(dt) {\r\n        if (this.node.y <= -50) {\r\n            Global.gameData.level = Global.gameData.level += 1;\r\n            console.log('难度系数：', Global.gameData.level);\r\n            this.resetTop();\r\n        } else {\r\n            this.node.y -= 3\r\n        }\r\n    },\r\n});\r\n"]}