{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\game/assets\\Script\\game\\block.js"],"names":["Global","require","cc","Class","extends","Component","properties","blastPrefab","default","type","Prefab","explode","blast","_x","node","x","width","_y","y","height","gameData","blastPool","size","get","log","instantiate","setPosition","parent","getComponent","ParticleSystem","resetSystem","scheduleOnce","put","onCollisionEnter","other","self","name","label","getChildByName","Label","datatype","string","active","pack","Number","forceful","color","Color","randomColor","dataxspeed"],"mappings":";;;;;;AAAA,IAAMA,SAASC,QAAQ,QAAR,CAAf;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,qBAAa;AACTC,qBAAS,IADA;AAETC,kBAAMP,GAAGQ;AAFA;AAFL,KAHP;AAUL;AACAC,WAXK,qBAWK;AACN,YAAIC,QAAQ,IAAZ;AAAA,YACIC,KAAK,KAAKC,IAAL,CAAUC,CAAV,GAAc,KAAKD,IAAL,CAAUE,KAAV,GAAkB,CADzC;AAAA,YAEIC,KAAK,KAAKH,IAAL,CAAUI,CAAV,GAAc,KAAKJ,IAAL,CAAUK,MAAV,GAAmB,CAF1C;AAGA,YAAInB,OAAOoB,QAAP,CAAgBC,SAAhB,CAA0BC,IAA1B,KAAmC,CAAvC,EAA0C;AACtCV,oBAAQZ,OAAOoB,QAAP,CAAgBC,SAAhB,CAA0BE,GAA1B,EAAR;AACH,SAFD,MAEO;AACHrB,eAAGsB,GAAH,CAAO,QAAP;AACAZ,oBAAQV,GAAGuB,WAAH,CAAe,KAAKlB,WAApB,CAAR;AACA;AACH;AACDK,cAAMc,WAAN,CAAkBb,EAAlB,EAAsBI,EAAtB;AACAL,cAAMe,MAAN,GAAe,KAAKb,IAAL,CAAUa,MAAzB;AACAf,cAAMgB,YAAN,CAAmB1B,GAAG2B,cAAtB,EAAsCC,WAAtC;AACA,aAAKC,YAAL,CAAkB,YAAM;AACpB/B,mBAAOoB,QAAP,CAAgBC,SAAhB,CAA0BW,GAA1B,CAA8BpB,KAA9B;AACH,SAFD,EAEG,GAFH;AAGH,KA5BI;;AA6BL;AACAqB,oBA9BK,4BA8BYC,KA9BZ,EA8BmBC,IA9BnB,EA8ByB;AAC1B;AACA,YAAID,MAAMpB,IAAN,CAAWsB,IAAX,IAAmB,QAAvB,EAAiC;AAC7B,gBAAIC,QAAQ,KAAKvB,IAAL,CAAUwB,cAAV,CAAyB,SAAzB,EAAoCV,YAApC,CAAiD1B,GAAGqC,KAApD,CAAZ;AACA,gBAAI9B,OAAO,KAAKK,IAAL,CAAU0B,QAArB;AACA,gBAAIH,MAAMI,MAAN,IAAgB,CAApB,EAAuB;AACnB;;;;;;AAMA;AACA;AACA;;AAEA;AACA,qBAAK9B,OAAL;AACA;AACA,qBAAKG,IAAL,CAAU4B,MAAV,GAAmB,KAAnB;AACH,aAfD,MAeO;AACH,oBAAI1C,OAAOoB,QAAP,CAAgBuB,IAAhB,IAAwB,UAA5B,EAAwC;AACpCN,0BAAMI,MAAN,GAAeG,OAAOP,MAAMI,MAAb,IAAuBzC,OAAOoB,QAAP,CAAgByB,QAAtD;AACA,wBAAIR,MAAMI,MAAN,IAAgB,CAApB,EAAuB;AACnB,6BAAK9B,OAAL;AACA,6BAAKG,IAAL,CAAU4B,MAAV,GAAmB,KAAnB;AACH;AACJ,iBAND,MAMO;AACHL,0BAAMI,MAAN,GAAeG,OAAOP,MAAMI,MAAb,IAAuB,CAAtC;AACH;AACD;AACA,qBAAK3B,IAAL,CAAUgC,KAAV,GAAkB,IAAI5C,GAAG6C,KAAP,CAAa/C,OAAOgD,WAAP,CAAmBX,MAAMI,MAAzB,EAAiChC,IAAjC,CAAb,CAAlB;AAEH;AACJ;AACD;AACA,YAAIyB,MAAMpB,IAAN,CAAWsB,IAAX,IAAmB,MAAvB,EAA+B;AAC3B,iBAAKtB,IAAL,CAAUmC,UAAV,GAAuB,CAAC,KAAKnC,IAAL,CAAUmC,UAAlC;AACH;AAEJ;AAtEI;AAuEL;;AAEA;;AAEA;;AAEA;AA7EJ","file":"block.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\game","sourcesContent":["const Global = require(\"Global\")\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 生成的粒子资源\r\n        blastPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n    },\r\n    // 粒子爆炸\r\n    explode() {\r\n        let blast = null,\r\n            _x = this.node.x + this.node.width / 2, \r\n            _y = this.node.y - this.node.height / 2;\r\n        if (Global.gameData.blastPool.size() > 0) {\r\n            blast = Global.gameData.blastPool.get();\r\n        } else {\r\n            cc.log('重新创建粒子');\r\n            blast = cc.instantiate(this.blastPrefab);\r\n            // blast.getComponent(cc.ParticleSystem).stopSystem();\r\n        }\r\n        blast.setPosition(_x, _y);\r\n        blast.parent = this.node.parent;\r\n        blast.getComponent(cc.ParticleSystem).resetSystem();\r\n        this.scheduleOnce(() => {\r\n            Global.gameData.blastPool.put(blast);\r\n        }, 0.1);\r\n    },\r\n    // 碰撞检测\r\n    onCollisionEnter(other, self) {\r\n        // 子弹碰撞\r\n        if (other.node.name == 'bullet') {\r\n            let label = this.node.getChildByName('boxtext').getComponent(cc.Label);\r\n            let type = this.node.datatype;\r\n            if (label.string == 1) {\r\n                /**\r\n                 * 粒子爆炸一\r\n                 * Auto Remove On 勾上\r\n                 * Play On Load 勾上\r\n                */\r\n\r\n                // let blast = cc.instantiate(this.blastPrefab);\r\n                // blast.setPosition(this.node.x + this.node.width / 2, this.node.y - this.node.height / 2);\r\n                // blast.parent = this.node.parent;\r\n\r\n                // 粒子爆炸二\r\n                this.explode();\r\n                // 方块消失\r\n                this.node.active = false;\r\n            } else {\r\n                if (Global.gameData.pack == 'forceful') {\r\n                    label.string = Number(label.string) - Global.gameData.forceful;\r\n                    if (label.string <= 0) {\r\n                        this.explode();\r\n                        this.node.active = false;\r\n                    }\r\n                } else { \r\n                    label.string = Number(label.string) - 1\r\n                }\r\n                // 改变颜色\r\n                this.node.color = new cc.Color(Global.randomColor(label.string, type));\r\n\r\n            }\r\n        }\r\n        // 碰撞到墙，反弹（废弃）\r\n        if (other.node.name == 'wall') {\r\n            this.node.dataxspeed = -this.node.dataxspeed\r\n        }\r\n\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    // start () {},\r\n\r\n    // update (dt) {},\r\n});\r\n"]}