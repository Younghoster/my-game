{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\game/assets\\Script\\game\\player.js"],"names":["Global","require","cc","Class","extends","Component","properties","bulletPrefab","default","type","Prefab","onCollisionEnter","other","self","that","resetFn","text","node","name","parent","removeChild","scheduleOnce","gameData","pack","console","log","game","gameEnd","bulletObjGroup","bulletPool","NodePool","i","bullet","instantiate","put","createBullet","parentNode","key","_x","getPosition","x","_y","y","height","size","get","setPosition","datakey","shooting","schedule","over","bulletNum","onLoad","start"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\game","sourcesContent":["const Global = require(\"Global\")\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 子弹资源\r\n        bulletPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        }\r\n    },\r\n\r\n    // 碰撞检测\r\n    onCollisionEnter(other, self) {\r\n        let that = this;\r\n        // 清除撞到的道具\r\n        function resetFn(text) {\r\n            if (other.node.name == text) other.node.parent.removeChild(other.node);\r\n            that.scheduleOnce(() => Global.gameData.pack = '', 5);\r\n        }\r\n        console.log('飞机撞到的物体：', other.node.name);\r\n        if (other.node.name == 'prop') {\r\n            Global.gameData.pack = 'three';\r\n            resetFn('prop');\r\n        } else if (other.node.name == 'forceful') {\r\n            Global.gameData.pack = 'forceful';\r\n            resetFn('forceful');\r\n        } else {\r\n            Global.game.gameEnd();\r\n        }\r\n    },\r\n    // 子弹对象池\r\n    bulletObjGroup() {\r\n        // 储存到 Global 里面\r\n        Global.gameData.bulletPool = new cc.NodePool();\r\n        for (let i = 0; i < 50; ++i) {\r\n            // 创建节点\r\n            let bullet = cc.instantiate(this.bulletPrefab);\r\n            // 通过 putInPool 接口放入对象池\r\n            Global.gameData.bulletPool.put(bullet);\r\n        }\r\n    },\r\n    /** \r\n     * 创建子弹\r\n     * key: 2 为直线射击 1 & 3 则左右两边倾斜射击\r\n    */\r\n    createBullet(parentNode, key = 2) {\r\n        let bullet = null,\r\n            _x = this.node.getPosition().x,\r\n            _y = this.node.getPosition().y + this.node.height / 4;\r\n        // 通过 size 接口判断对象池中是否有空闲的对象\r\n        if (Global.gameData.bulletPool.size() > 0) {\r\n            bullet = Global.gameData.bulletPool.get();\r\n        } else {\r\n            // 如果没有空闲对象，也就是对象池中备用对象不够时，我们就用 cc.instantiate 重新创建\r\n            bullet = cc.instantiate(this.bulletPrefab);\r\n        }\r\n        bullet.setPosition(_x, _y);\r\n        // 将生成的敌人加入节点树\r\n        bullet.parent = parentNode;\r\n        // 设置key标记\r\n        bullet.datakey = key\r\n        // cc.log(bullet.datakey)\r\n    },\r\n    shooting() {\r\n        this.schedule(() => {\r\n            if (Global.gameData.over) return;\r\n            // 检查获取道具包\r\n            if (Global.gameData.pack === 'three') {\r\n                for (let i = 1; i <= 3; i++) {\r\n                    this.createBullet(Global.game.node, i);\r\n                }\r\n            } else {\r\n                this.createBullet(Global.game.node);\r\n            }\r\n        },1 / Global.gameData.bulletNum)\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        // 创建子弹对象池\r\n        this.bulletObjGroup();\r\n    },\r\n\r\n    start () {\r\n        // this.getComponent('player')\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}